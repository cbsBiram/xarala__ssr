{% extends "_dashboard_base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% block title %} {{ title }} {% endblock title %}
{% block sidebar %} {% include "partials/_sidebar_dashboard.html" %} {% endblock sidebar %}

{% block content %}
<div style="margin-bottom: 30px;">
    <div class="inmuHv jYirZ">
        <input type="text" autocapitalize="sentences" placeholder="Ajouter un titre à votre cours"
            style="font-size: 2.1rem !important;" name="course_title" required>
    </div>
</div>
<div class="my-chapter">
    <div class="jjarOm bqfDsc chapter" style="margin-top: 40px;">
        <div class="col-12">
            <div class="inmuHv jYirZ">
                <input type="text" autocapitalize="sentences" name="chapter_name"
                    placeholder="Ajouter un titre à votre chapitre" required>
            </div>
            <div class="dropdown d-flex justify-content-end" style="position: relative; top: -40px; right: -20px">
                <a class=" btn" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true"
                    aria-expanded="false">
                    <i class="fas fa-ellipsis-v" style="font-size: large;"></i>
                </a>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <button class="btn btn-sm">
                        <a href="#" title="Add Lesson" class="dropdown-item add-lesson-btn">
                            <svg width="16" height="16" viewBox="0 0 16 16">
                                <g fill="none" fill-rule="evenodd">
                                    <g fill="#13131A">
                                        <path
                                            d="M10.01.624L6.74 3.893 3.467.622C3 .133 2.303-.063 1.648.108.991.279.48.79.31 1.447c-.17.655.028 1.352.517 1.82l3.27 3.271L.829 9.806c-.71.734-.7 1.902.022 2.625.722.723 1.89.733 2.625.022L6.739 9.18l3.269 3.27c.47.487 1.166.683 1.82.512.655-.17 1.167-.682 1.338-1.337.17-.655-.025-1.351-.513-1.82L9.39 6.54l3.267-3.268c.71-.734.701-1.902-.021-2.625-.722-.723-1.89-.733-2.625-.023z"
                                            transform="translate(-2511 -602) translate(1918 458) translate(593 144) translate(1.778 1.778)">
                                        </path>
                                    </g>
                                </g>
                            </svg>
                            Supprimer
                        </a>
                    </button>
                </div>
            </div>
        </div>

        <div id="sortable"></div>

        <div class="gMCPru">
            <div class="esedNQ">
                <div class="ivYHKm">
                    <div class="dropdown">
                        <a class=" btn" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false">
                            Ajouter une leçon*
                            <i class="fas fa-plus-circle" style="font-size: 18px"></i>
                        </a>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">

                            <button class="btn btn-sm add-title-btn">
                                <a href="#" title="Title" class="dropdown-item">
                                    <div class="d-flex flex-row">
                                        <svg width="18" height="18" viewBox="0 0 18 18">
                                            <g fill="#13131A" fill-rule="nonzero">
                                                <path
                                                    d="M0.167 0.333L0.167 2.833 4.75 2.833 4.75 12.833 7.25 12.833 7.25 2.833 11.833 2.833 11.833 0.333z"
                                                    transform="translate(-802 -727) translate(785 555) translate(17 172) translate(3 3)">
                                                </path>
                                            </g>
                                        </svg>
                                        <div class="ibgLNl ml-1">Titre</div>
                                    </div>
                                </a>
                            </button>
                            <button class="btn btn-sm add-video-btn">
                                <a href="#" title="Add Video" class="dropdown-item">
                                    <div class="d-flex flex-row">
                                        <svg width="20" height="20" viewBox="0 0 20 20">
                                            <g fill="none" fill-rule="evenodd">
                                                <g fill-rule="nonzero">
                                                    <path fill="red"
                                                        d="M0 10C0 4.477 4.477 0 10 0s10 4.477 10 10-4.477 10-10 10S0 15.523 0 10z"
                                                        transform="translate(-36 -796) translate(36 796)"></path>
                                                    <path fill="#FFF"
                                                        d="M15.11 7.53c-.122-.47-.484-.842-.943-.968C13.336 6.333 10 6.333 10 6.333s-3.336 0-4.167.23c-.46.125-.82.496-.943.968-.223.854-.223 2.636-.223 2.636s0 1.782.223 2.636c.122.471.484.842.943.968C6.664 14 10 14 10 14s3.336 0 4.167-.229c.46-.126.82-.497.943-.968.223-.854.223-2.636.223-2.636s0-1.782-.223-2.636"
                                                        transform="translate(-36 -796) translate(36 796)"></path>
                                                    <path fill="red" d="M9 12L9 8.667 11.667 10.333z"
                                                        transform="translate(-36 -796) translate(36 796)"></path>
                                                </g>
                                            </g>
                                        </svg>
                                        <div class="ibgLNl ml-1">Vidéo</div>
                                    </div>
                                </a>
                            </button>
                            <button class="btn btn-sm add-description-btn">
                                <a href="#" title="Add Description" class="dropdown-item lmfOYQ">
                                    <div class="d-flex flex-row">
                                        <svg width="18" height="18" viewBox="0 0 18 18">
                                            <g fill="none" fill-rule="evenodd">
                                                <path fill="#000" fill-rule="nonzero"
                                                    d="M4.429 1.375h6.237c.281 0 .553.1.767.28l3.771 3.19c.267.226.421.558.421.907v9.939c0 1.417-.016 1.517-1.47 1.517H4.429c-1.454 0-1.47-.1-1.47-1.517V2.892c0-1.417.016-1.517 1.47-1.517z"
                                                    transform="translate(-852 -770) translate(835 564) translate(17 206)">
                                                </path>
                                            </g>
                                        </svg>
                                        <div class="ibgLNl ml-1">Description</div>
                                    </div>
                                    <input type="file" class="d-none">
                                </a>
                            </button>
                            <button class="btn btn-sm">
                                <a href="#" title="Add Question" class="dropdown-item add-quiz-btn">
                                    <div class="d-flex flex-row">
                                        <svg width="18" height="18" viewBox="0 0 18 18">
                                            <g fill="none" fill-rule="evenodd">
                                                <path d="M0 0H18V18H0z"
                                                    transform="translate(-772 -1744) translate(755 1608) translate(17 136)">
                                                </path>
                                                <path fill="#13131A"
                                                    d="M15.617 12.283c.716 0 1.3.567 1.3 1.3 0 .717-.584 1.3-1.3 1.3H7.333c-.716 0-1.3-.583-1.3-1.3 0-.716.584-1.3 1.3-1.3zm-12.284 0c.717 0 1.3.567 1.3 1.3 0 .717-.583 1.3-1.3 1.3h-.95c-.716 0-1.3-.583-1.3-1.3 0-.716.584-1.3 1.3-1.3zM15.617 7.7c.716 0 1.3.583 1.3 1.3 0 .717-.584 1.3-1.3 1.3H7.333c-.716 0-1.3-.583-1.3-1.3 0-.717.584-1.3 1.3-1.3zm-12.284 0c.717 0 1.3.583 1.3 1.3 0 .717-.583 1.3-1.3 1.3h-.95c-.716 0-1.3-.583-1.3-1.3 0-.717.584-1.3 1.3-1.3zm12.284-4.583c.716 0 1.3.583 1.3 1.3 0 .716-.584 1.3-1.3 1.3H7.333c-.716 0-1.3-.584-1.3-1.3 0-.717.584-1.3 1.3-1.3zm-12.284 0c.717 0 1.3.583 1.3 1.3 0 .716-.583 1.3-1.3 1.3h-.95c-.716 0-1.3-.584-1.3-1.3 0-.717.584-1.3 1.3-1.3z"
                                                    transform="translate(-772 -1744) translate(755 1608) translate(17 136)">
                                                </path>
                                            </g>
                                        </svg>
                                        <div class="ibgLNl ml-1">
                                            Question
                                        </div>
                                    </div>
                                </a>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="quiz_section"></div>

    </div>
</div>

<div id="insert_chapter"></div>

<div class="ivYHKm" id="add_new_chapter" style="margin-top: 40px;">
    <div>Ajouter un nouveau chapitre</div>
    <svg width="18" height="18" viewBox="0 0 18 18">
        <g fill="#13131A">
            <path
                d="M.535 3.851v.012l5.9 2.691h.006c.355.165.765.165 1.12 0h.006l5.9-2.691v-.012c.223-.074.376-.278.384-.513-.008-.236-.163-.442-.389-.514L7.57.124h-.011c-.354-.165-.764-.165-1.118 0H6.43l-5.89 2.7c-.226.072-.381.278-.389.514.008.235.161.44.384.513z"
                transform="translate(-937 -2179) translate(447 2137) translate(331 42) translate(159) translate(2 2)">
            </path>
            <path
                d="M13.46 6.485l-1.153-.529C10.5 6.783 8.03 7.909 8 7.919c-.642.255-1.358.255-2 0-.028-.009-2.494-1.134-4.3-1.962l-1.16.528c-.23.064-.389.273-.39.512-.001.238.156.448.385.515v.011l5.9 2.692h.006c.355.165.765.165 1.12 0h.006l5.9-2.692v-.011c.23-.065.387-.275.387-.513 0-.239-.158-.449-.387-.514h-.007z"
                transform="translate(-937 -2179) translate(447 2137) translate(331 42) translate(159) translate(2 2)">
            </path>
            <path
                d="M13.46 10.148l-1.153-.529C10.5 10.447 8.03 11.573 8 11.582c-.642.257-1.358.257-2 0-.028-.009-2.494-1.134-4.3-1.962l-1.16.528c-.23.065-.388.274-.39.512 0 .238.156.449.385.516v.011l5.9 2.691h.006c.355.165.765.165 1.12 0h.006l5.9-2.691v-.011c.229-.066.387-.276.387-.514s-.158-.448-.387-.514h-.007z"
                transform="translate(-937 -2179) translate(447 2137) translate(331 42) translate(159) translate(2 2)">
            </path>
        </g>
    </svg>
</div>

<div class="mt-4">
    <div class="iHhhTz">
        <button class="hJLFyW" id="save-draft-btn" data-url="{% url 'dashboard:create-course'  %}">Enregistrer</button>
        <button disabled=""
            class="defaultButton__DefaultButton-sc-1scxgx7-0 primaryButton__PrimaryButton-sc-1t32hmz-0 jRKnYV khmjno">Publier</button>
    </div>
    <div class="jwyJKT">Les champs avec des asterisks (*) doivent être remplis pour que le cours soit publié. À
        l'enregistrement, seul le titre du cours est obligatoire.</div>
</div>


{% endblock %}

{% block extrajs %}

{% block semantic %} {% endblock semantic %}
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>

<script>
    $(document).ready(function () {
        $('#summernote').summernote();

        $("#sortable").sortable({
            revert: true
        });
        $("#draggable").draggable({
            connectToSortable: "#sortable",
            helper: "clone",
            revert: "invalid"
        });

        $("#draggable").draggable();

        $("ul, li").disableSelection();

        $('#add_new_chapter').on('click', function () {
            var len = $('.chapter').length;
            var $htmlToAdd = $('div.my-chapter').clone()
            $htmlToAdd.removeClass('my-chapter').addClass('my-chapter-' + len)
            $htmlToAdd.insertBefore('#insert_chapter')

        })

        $('.add-title-btn').on('click', function () {
            var len = $('.chapter').length;
            console.log($(this).parent().parent())

            var $htmlToAdd = '<div class="eQVCSW"><div class="inmuHv dfZJeY">' +
                '<input type="text" autocapitalize="sentences" name="lesson_' + len + '-name" placeholder="Ajouter le titre de la leçon">' +
                '</div><div class="gMCPru gulyia eKocqC"><div class="esedNQ">' +
                '<svg width="18" height="19" viewBox="0 0 18 19" class="hwgExz"><g fill="none" fill-rule="evenodd">' +
                '<path d="M0 0H18V18H0z" transform="translate(-358 -198) translate(51 180) translate(18 18.5) translate(289)">' +
                '</path><path fill="#13131A" d="M9 12.75c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5-1.5-.672-1.5-1.5.672-1.5 1.5-1.5zM9 7.5c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5S7.5 9.828 7.5 9 8.172 7.5 9 7.5zm0-5.25c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5-1.5-.672-1.5-1.5.672-1.5 1.5-1.5z" transform="translate(-358 -198) translate(51 180) translate(18 18.5) translate(289)">' +
                '</path></g></svg></div></div></div>';
            var $sortableComponent = $('div#sortable');
            $sortableComponent.append($htmlToAdd);
        })

        $('.add-video-btn').on('click', function () {
            event.preventDefault()
            var $htmlToAdd = '<div class="hkJnVs mt-4"><div class="ynJOs">' +
                '<div class="jgZALD"><svg width="20" height="20" viewBox="0 0 20 20">' +
                '<g fill="none" fill-rule="evenodd"><g fill-rule="nonzero">' +
                '<path fill="red" d="M0 10C0 4.477 4.477 0 10 0s10 4.477 10 10-4.477 10-10 10S0 15.523 0 10z" transform="translate(-36 -796) translate(36 796)"></path>' +
                '<path fill="#FFF" d="M15.11 7.53c-.122-.47-.484-.842-.943-.968C13.336 6.333 10 6.333 10 6.333s-3.336 0-4.167.23c-.46.125-.82.496-.943.968-.223.854-.223 2.636-.223 2.636s0 1.782.223 2.636c.122.471.484.842.943.968C6.664 14 10 14 10 14s3.336 0 4.167-.229c.46-.126.82-.497.943-.968.223-.854.223-2.636.223-2.636s0-1.782-.223-2.636" transform="translate(-36 -796) translate(36 796)">' +
                '</path><path fill="red" d="M9 12L9 8.667 11.667 10.333z" transform="translate(-36 -796) translate(36 796)"></path></g></g></svg>' +
                '<input placeholder="Add here the Youtube link"></div></div>' +
                '<div class="gMCPru gulyia eKocqC">' +
                '<div class="esedNQ"><svg width="18" height="19" viewBox="0 0 18 19" class="kebabMenu__BigKebab-sc-1f2nmz8-1 hwgExz">' +
                '<g fill="none" fill-rule="evenodd"><path d="M0 0H18V18H0z" transform="translate(-358 -198) translate(51 180) translate(18 18.5) translate(289)">' +
                '</path><path fill="#13131A" d="M9 12.75c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5-1.5-.672-1.5-1.5.672-1.5 1.5-1.5zM9 7.5c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5S7.5 9.828 7.5 9 8.172 7.5 9 7.5zm0-5.25c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5-1.5-.672-1.5-1.5.672-1.5 1.5-1.5z" transform="translate(-358 -198) translate(51 180) translate(18 18.5) translate(289)">' +
                '</path></g></svg></div></div></div>';
            var $sortableComponent = $('div#sortable');
            $sortableComponent.append($htmlToAdd);
        })

        $('.add-description-btn').on('click', function () {
            var $htmlToAdd = '<div class="eQVCSW"><div class="inmuHv dfZJeY">' +
                '<textarea id="summernote"></textarea>' +
                '</div><div class="gMCPru gulyia eKocqC"><div class="esedNQ">' +
                '<svg width="18" height="19" viewBox="0 0 18 19" class="hwgExz"><g fill="none" fill-rule="evenodd">' +
                '<path d="M0 0H18V18H0z" transform="translate(-358 -198) translate(51 180) translate(18 18.5) translate(289)">' +
                '</path><path fill="#13131A" d="M9 12.75c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5-1.5-.672-1.5-1.5.672-1.5 1.5-1.5zM9 7.5c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5S7.5 9.828 7.5 9 8.172 7.5 9 7.5zm0-5.25c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5-1.5-.672-1.5-1.5.672-1.5 1.5-1.5z" transform="translate(-358 -198) translate(51 180) translate(18 18.5) translate(289)">' +
                '</path></g></svg></div></div></div>';
            var $sortableComponent = $('div#sortable');
            $sortableComponent.append($htmlToAdd);
        })

        $('.add-quiz-btn').on('click', function () {
            event.preventDefault()
            var $htmlToAdd = '<div class="fmgnGK">Quiz</div><div class="">' +
                '<div class="question-section"><div class="view-question"></div><div class="add-question"></div></div>' +
                '<div class="jjarOm kehBGJ bjYTln question-form">' +
                '<div ><div><div class="kLHfqT">Question 1</div>' +
                '<div class="inmuHv" style="margin-bottom: 15px;"><input type="text" autocapitalize="sentences" placeholder="Edit the question...*"></div></div>' +
                '<div class="dZwVYc"><div class="gkeyhG"><div class="exerciseEditor__ChoiceIndex-sc-1hguq4q-4 jGSZkH" style="margin-bottom: 15px;"><div class="exerciseEditor__ChoiceIndex-sc-1hguq4q-4 ksjfCD">1</div><div class="inmuHv">' +
                '<input id="0262de6c-5525-47b7-8ab7-3c1007fea52b" data-id="0262de6c-5sortable525-47b7-8ab7-3c1007fea52b" type="text" autocapitalize="sentences" placeholder="Answer 1*">' +
                '</div></div></div>' +
                '<div class="new-answer"></div>' +
                '</div>' +
                '<div class="eWWrhn ivYHKm add-answer-btn" style="margin-bottom: 18px;"><button class="btn">Ajouter une réponse<i class="fas fa-plus-circle ml-1"></i></button>' +
                '</div><div><div class="kLHfqT">Choose the right answer</div>' +
                '<div class="fFlPup"><div class="exerciseEditor__ChoiceIndex-sc-1hguq4q-4 ksjfCD">1</div>' +
                '<div class="right-answer-choice"></div></div></div>' +
                '<div><div class="ixkpGJ"><button class="hJLFyW">Cancel</button><button class="jRKnYV khmjno save-question-btn">Ok</button></div></div></div></div>';
            var $sortableComponent = $('div#quiz_section');
            $sortableComponent.append($htmlToAdd);

            $('.add-answer-btn').on('click', function () {
                var $answerToAdd = '<div class="exerciseEditor__ChoiceWrapper-sc-1hguq4q-3 gkeyhG">' +
                    '<div class="exerciseEditor__Choice-sc-1hguq4q-5 jGSZkH">' +
                    '<div class="exerciseEditor__ChoiceIndex-sc-1hguq4q-4 ksjfCD">2</div>' +
                    '<div class="materialTextInput__Container-sc-1aj17jz-0 inmuHv">' +
                    '<input id="e9a9c8ae-da9a-4886-b611-11a2b1e0530b" data-id="e9a9c8ae-da9a-4886-b611-11a2b1e0530b" type="text" autocapitalize="sentences" placeholder="Answer 1*">' +
                    '</div></div><svg width="16" height="16" viewBox="0 0 16 16"><g fill="none" fill-rule="evenodd"><g fill="#13131A"><path d="M10.01.624L6.74 3.893 3.467.622C3 .133 2.303-.063 1.648.108.991.279.48.79.31 1.447c-.17.655.028 1.352.517 1.82l3.27 3.271L.829 9.806c-.71.734-.7 1.902.022 2.625.722.723 1.89.733 2.625.022L6.739 9.18l3.269 3.27c.47.487 1.166.683 1.82.512.655-.17 1.167-.682 1.338-1.337.17-.655-.025-1.351-.513-1.82L9.39 6.54l3.267-3.268c.71-.734.701-1.902-.021-2.625-.722-.723-1.89-.733-2.625-.023z" transform="translate(-2511 -602) translate(1918 458) translate(593 144) translate(1.778 1.778)">' +
                    '</path></g></g></svg></div>';
                var $choiceToAdd = '<div class="exerciseEditor__ChoiceIndex-sc-1hguq4q-4 ksjfCD">2</div>';
                var $answerSection = $('div.new-answer');
                var $choiceSection = $('div.right-answer-choice');

                $answerSection.append($answerToAdd);
                $choiceSection.append($choiceToAdd);
            })

            $('.save-question-btn').on('click', function () {
                var $questionViewToAdd = '<div class="jjarOm bFucVQ iuVOof gmrWGH" style="margin-bottom: 15px">' +
                    '<div class="primary__Primary-sc-16k2f7-0 bgQjcd"><b>Question 1</b></div>' +
                    '<div class="primary__Primary-sc-16k2f7-0 bgQjcd"><b>uyi</b></div><div class="exerciseView__Answers-sc-19oun2q-2 giWrJk">' +
                    '<div class="exerciseView__Choice-sc-19oun2q-3 hRaafP">' +
                    '<input id="3950b499-9f75-4f43-9bf5-ab5a0354fa4d" name="3950b499-9f75-4f43-9bf5-ab5a0354fa4d" disabled="" type="checkbox" checked="">' +
                    '<label for="3950b499-9f75-4f43-9bf5-ab5a0354fa4d">tri</label></div></div>' +
                    '<div class="menu__Container-nkqbdm-0 gMCPru kebabMenu__BlurredMenu-sc-1f2nmz8-0 gulyia exerciseEditorWrapper__StyledKebabMenu-sc-1t8kjya-1 eOnonT">' +
                    '<div class="menu__MenuLayout-nkqbdm-1 esedNQ"><svg width="18" height="19" viewBox="0 0 18 19" class="kebabMenu__BigKebab-sc-1f2nmz8-1 hwgExz">' +
                    '<g fill="none" fill-rule="evenodd"><path d="M0 0H18V18H0z" transform="translate(-358 -198) translate(51 180) translate(18 18.5) translate(289)"></path>' +
                    '<path fill="#13131A" d="M9 12.75c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5-1.5-.672-1.5-1.5.672-1.5 1.5-1.5zM9 7.5c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5S7.5 9.828 7.5 9 8.172 7.5 9 7.5zm0-5.25c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5-1.5-.672-1.5-1.5.672-1.5 1.5-1.5z" transform="translate(-358 -198) translate(51 180) translate(18 18.5) translate(289)">' +
                    '</path></g></svg></div></div></div>';
                var addQuestionBtn = '<div class="ivYHKm mt-4"><div><button class="btn">Nouvelle question</div><i class="fas fa-plus-circle ml-1"></i></button></div>'
                var $questionSection = $('div.view-question');
                var $questionBtnSection = $('div.add-question');
                $('.question-form').remove()

                $questionSection.append($questionViewToAdd);
                $questionBtnSection.append(addQuestionBtn)
            })
        })

        $('#save-draft-btn').on('click', function () {
            var $courseTitle = $("input[name=course_title]")
            var $chapterName = $("input[name=chapter_name]")
            var $thisURL = $(this).attr('data-url');

            $.ajax({
                type: 'POST',
                url: $thisURL,
                data: {
                    courseTitle: $courseTitle.val(),
                    chapterName: $chapterName.val(),
                    csrfmiddlewaretoken: '{{ csrf_token }}'
                },
                success: function (data) {
                    console.log(data)
                }
            })
        })
    })
</script>
{% endblock extrajs %}