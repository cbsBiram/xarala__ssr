{% extends "_base.html" %}
{% load embed_video_tags %}

{% block title %}
{{ lesson.title }}
{% endblock title %}

{% block content %}
<section class="paddingBottom-100">
  <div class="container">

    <h2 class="mt-4">
      {{ lesson.title }}
    </h2>
    <div class="row">
      <div class="col-lg-8 ">
        <div class="ec-video-container my-4">
          {% if lesson.video_url %}
          {% video lesson.video_url 'small' %}
          {% else %}
          <iframe src="https://www.youtube.com/embed/{{ lesson.video_id }}?rel=0"></iframe>
          {% endif %}
        </div>
        <p>
          {{ lesson.text|safe }}
        </p>

        <div class="row">
          <div class="col-12">
            <ul class="pagination pagination-primary align-items-center justify-content-center">
              {% if lesson.previous %}
              <li class="page-item">
                <a class="page-link width-8rem text-center"
                  href="{% url 'course:course-detail' object.slug %}?lecture={{lesson.previous.slug}}">
                  <i class="ti-arrow-left small mr-0"></i>
                  Précédent
                </a>
              </li>
              {% endif %}
              {% if lesson.next %}
              <li class="page-item">
                <a class="page-link width-8rem text-center"
                  href="{% url 'course:course-detail' object.slug %}?lecture={{lesson.next.slug}}">
                  Suivant
                  <i class="ti-arrow-right small ml-2"></i>
                </a>
              </li>
              {% endif %}
            </ul>

          </div> <!-- END col-12 -->
        </div> <!-- END row-->

      </div>
      <div class="col-lg-4 ">
        <div>
          <div id="accordionCurriculum">
            {% if object.course_chapters.all %}
            {% for chapter in object.course_chapters.all %}

            <div class="accordion-item list-group mb-3">

              <div class="list-group-item bg-light">
                <a class="row" href="#accordionCurriculum_{{ chapter.id }}" data-toggle="collapse" aria-expanded="true">
                  <span class="col-9 col-md-8">
                    <span class="accordion__icon text-primary mr-2">
                      <i class="ti-plus"></i>
                      <i class="ti-minus"></i>
                    </span>
                    <span class="h6 d-inline">{{ chapter.name }}</span>
                  </span>
                </a>
              </div>

              <div id="accordionCurriculum_{{ chapter.id }}" class="collapse show" data-parent="#accordionCurriculum">

                {% if chapter.course_lessons.all  %}
                {% for lesson in chapter.course_lessons.all  %}
                {% if lesson.chapter.id == chapter.id %}
                <div class="list-group-item">
                  <span class="row">
                    <a class="col-9 col-md-8 {% if lesson.slug in request.get_full_path %} active {% endif %}"
                      href="{% url 'course:course-detail' object.slug %}?lecture={{lesson.slug}}">
                      <i class="ti-control-play small mr-1 text-primary"></i>
                      {{ lesson.title }}
                    </a>
                    <span class="col-3 col-md-2 ml-auto text-right">10:36</span>
                  </span>
                </div>
                {% endif %}
                {% endfor %}
                {% endif %}

              </div>
            </div> <!-- END accordion-item -->

            {% endfor %}
            {% endif %}

          </div> <!-- END accordion-->
        </div> <!-- END tab-pane -->
      </div>

    </div> <!-- END row-->
  </div> <!-- END container-->
</section>

{% endblock content %}