{% extends "_base.html" %}
{% load static %}
{% load embed_video_tags %}

{% block title %}
{{ course.title }}
{% endblock title %}

{% block content %}

{% include "partials/_breadcrumbs.html" with previous="Cours" previous_url="course:courses" current="Détails" text="Details cours" %}

<section class="paddingBottom-100">
  <div class="container">

    <div class="row">
      <div class="col-lg-12 marginTop-30">
        <h1>
          {{ course.title }}
        </h1>
        {% include "partials/_animated-share.html" with title=course.title %}
        <div class="row mt-3">
          <div class="col-lg-3 col-md-6 my-2">
            <div class="media border-right height-100p">
              <img class="iconbox mr-3"
                src="{% if course.teacher.avatar %} {{ course.teacher.avatar.url }} {% else %} {% static 'assets/img/262x230/1.jpg' %} {% endif %}"
                alt="{{ course.teacher.get_full_name }}">
              <div class="media-body">
                <span class="text-gray d-block">Formateur:</span>
                <a href="#" class="h6">{{ course.teacher.get_full_name|default_if_none:"Xarala" }}</a>
              </div>
            </div>
          </div>
          <div class="col-lg-3 col-md-6 my-2">
            <div class="border-right height-100p">
              <span class="text-gray d-block">Langue:</span>
              <h6 class="mb-0">{{ course.language.name }}</h6>
            </div>
          </div>
          <div class="col-lg-3 col-md-6 my-2">
            <div class="border-right height-100p">
              <span class="text-gray">Niveau:</span>
              <h6 class="mb-0">
                {{ course.level }}
              </h6>
            </div>
          </div>
          <div class="col-lg-3 col-md-6 my-2">
            <div class="text-md-right height-100p">

              {% if course.price %}
              <h2 class="font-weight-bold text-primary mb-2">
                {{ course.price }} XOF</h2>
              {% else %}
              <h2 class="font-weight-bold text-success mb-2">
                Gratuit</h2>
              {% endif %}
              <a class="btn btn-primary"
                href="{% if button_text == 'Enroller'  %}{% url 'course:subscribe_user_to_course' course.slug %}{% else %}/courses/{{ course.slug }}/?lecture={{course.get_introudction.slug}}{% endif %}">{{ button_text }}</a>


            </div>
          </div>
        </div> <!-- END row-->

        <div class="ec-video-container my-4">

          {% if course.promote_video %}
          {% video course.promote_video 'small' %}
          {% else %}
          <iframe src="https://www.youtube.com/embed/{{ course.get_introudction.video_id }}?rel=0"></iframe>
          {% endif %}

        </div>

        <div class="card padding-30 shadow-v3">
          <h4>
            Détails sur le cours:
          </h4>
          <ul class="list-inline mb-0 mt-2">
            <li class="list-inline-item my-2 pr-md-4">
              <i class="ti-headphone small text-primary"></i>
              <span class="ml-2">{{ course.count_lessons }} lectures</span>
            </li>
            <li class="list-inline-item my-2 pr-md-4">
              <i class="ti-user small text-primary"></i>
              <span class="ml-2">{{ course.count_students }} Étudiants</span>
            </li>
            <li class="list-inline-item my-2 pr-md-4">
              <i class="ti-reload small text-primary"></i>
              <span class="ml-2">Accès à vie</span>
            </li>
            <li class="list-inline-item my-2 pr-md-4">
              <i class="ti-crown small text-primary"></i>
              <span class="ml-2">Qualité garantie</span>
            </li>
            <li class="list-inline-item my-2 pr-md-4">
              <i class="ti-crown small text-primary"></i>
              <span class="ml-2">certificat d'achèvement</span>
            </li>

          </ul>
        </div>

        <div class="col-12 mt-4">
          <ul class="nav tab-line tab-line tab-line--3x border-bottom mb-5" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" data-toggle="tab" href="#tabDescription" role="tab" aria-selected="true">
                Description
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="tab" href="#tabCurriculum" role="tab" aria-selected="true">
                Curriculum
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="tab" href="#tabInstructors" role="tab" aria-selected="true">
                Formateur
              </a>
            </li>
          </ul>
          <div class="tab-content">
            <div class="tab-pane fade show active" id="tabDescription" role="tabpanel">
              <h4>
                Description du cours
              </h4>
              <p>
                {{ course.description|safe }}
              </p>


              <div class="row mt-5 cours-description">
                <div class="col-md-6 my-2">
                  <h4>
                    Que vais-je apprendre?
                  </h4>
                  <ul class="list-unstyled list-style-icon list-icon-check">
                    {{ course.what_will_i_learn|safe }}
                  </ul>
                </div>
                <div class="col-md-6 my-2">
                  <h4>
                    Projets à réaliser
                  </h4>
                  <ul class="list-unstyled list-style-icon list-icon-check">
                    {{ course.projects|safe }}
                  </ul>
                </div>

                <div class="col-md-6 my-2">
                  <h4>
                    Prérequis
                  </h4>
                  <ul class="list-unstyled list-style-icon list-icon-bullet">
                    {{ course.requirements|safe }}
                  </ul>
                </div>

                <div class="col-md-6 my-2">
                  <h4>
                    Cible?
                  </h4>
                  <ul class="list-unstyled list-style-icon list-icon-bullet">
                    {{ course.target_audience|safe }}
                  </ul>
                </div>
              </div> <!-- END row-->
            </div> <!-- END tab-pane-->

            <div class="tab-pane fade" id="tabCurriculum" role="tabpanel">
              <div id="accordionCurriculum">
                {% if object.course_chapters.all %}
                {% for chapter in object.course_chapters.all %}


                <div class="accordion-item list-group mb-3">

                  <div class="list-group-item bg-light">
                    <a class="row" href="#accordionCurriculum_{{ chapter.id }}" data-toggle="collapse"
                      aria-expanded="true">
                      <span class="col-9 col-md-8">
                        <span class="accordion__icon text-primary mr-2">
                          <i class="ti-plus"></i>
                          <i class="ti-minus"></i>
                        </span>
                        <span class="h6 d-inline">{{ chapter.name }}</span>
                      </span>
                    </a>
                  </div>

                  <div id="accordionCurriculum_{{ chapter.id }}" class="collapse show"
                    data-parent="#accordionCurriculum">

                    {% if chapter.course_lessons.all  %}
                    {% for lesson in chapter.course_lessons.all  %}
                    {% if lesson.chapter.id == chapter.id %}
                    <div class="list-group-item">
                      <span class="row">
                        <a class="col-9 col-md-8" href="#">
                          <i class="ti-control-play small mr-1 text-primary"></i>
                          {{ lesson.title }}
                        </a>

                        {% if lesson.preview %}
                        <span class="col-2 d-none d-md-block text-right">
                          <a href="https://www.youtube.com/embed/{{ lesson.video_id }}?rel=0" data-fancybox
                            class="text-success">Preview</a>
                        </span>
                        {% endif %}

                        <span class="col-3 col-md-2 ml-auto text-right">10:36</span>
                      </span>
                    </div>
                    {% endif %}
                    {% endfor %}
                    {% endif %}





                  </div>
                </div> <!-- END accordion-item -->

                {% endfor %}
                {% endif %}

              </div> <!-- END accordion-->
            </div> <!-- END tab-pane -->


            <div class="tab-pane fade" id="tabInstructors" role="tabpanel">
              <h4>
                A propos du formateur
              </h4>

              <div class="border-bottom mb-4 pb-4">
                <div class="d-md-flex mb-4">
                  <a href="#">
                    <img class="iconbox iconbox-xxxl"
                      src="{% if course.teacher.avatar %} {{ course.teacher.avatar.url }} {% else %} {% static 'assets/img/262x230/1.jpg' %} {% endif %}"
                      alt="{{ course.teacher.get_full_name }}">
                  </a>
                  <div class="media-body ml-md-4 mt-4 mt-md-0">
                    <h6>
                      {{ course.teacher.get_full_name|default_if_none:"Formateur" }}
                    </h6>
                    <p class="mb-2">
                      <i class="ti-world mr-2"></i>
                      {{ course.teacher.title|default_if_none:"Formateur" }}
                    </p>
                    <ul class="list-inline">
                      <li class="list-inline-item mb-2">
                        <i class="ti-book mr-1"></i>
                        {{ course.teacher.courses_created.count }} Cours
                      </li>
                    </ul>
                    <a href="#" class="btn btn-outline-primary btn-pill btn-sm">Voir Son Profile</a>
                  </div>
                </div>
              </div>


            </div> <!-- END tab-pane -->



          </div> <!-- END tab-content-->
        </div> <!-- END col-12 -->
      </div> <!-- END col-lg-9 -->



    </div> <!-- END row-->
  </div> <!-- END container-->
</section>


{% endblock content %}